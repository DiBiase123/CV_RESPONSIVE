<div class="offcanvas offcanvas-end text-dark" id="modal_whatsapp" data-bs-scroll="true" tabindex="-1" aria-labelledby="whatsapp_offcanvasLabel">
  <div id="bot">
    <div class="offcanvas-header" style="background: #C0C0C0;">
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    <div> 
  </div>


    </div>

    <div class="container text-light text-end me-4 mt-2">
        <p style="font-size: 0.7em;"> Version 1.0 </p>
    </div>

    <div class="offcanvas-body">
      <div class="card " id="bg_whatsapp" style="max-height: 65vh;">
        <div class="card-body text-end" id="body_whatsapp">
          <!-- +++ INTELLIGENCE ARTIFI +++ -->
          <img class="rounded-pill " width="15%" src="https://pps.whatsapp.net/v/t61.24694-24/118003287_746051199521910_3903675907476248517_n.jpg?ccb=11-4&oh=01_AdTYSMGtnnfSmPZ_LooY_fXycpeiwJNzDBLhDa4yL60x3A&oe=65A99526&_nc_sid=e6ed6c&_nc_cat=110" alt="foto" >

          <div class="box3 col-md-10">
            <div class="bot-reply">

              <p> Bonjour, laissez un message, je vous contacterai d√®s que possible. 
              <p class="text-end text-dark p-0 m-0 me-1 mt-0" style="font-size: smaller;">
              <?php echo date("H:i"); ?> 
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check2 text-secondary" viewBox="0 0 16 16">
                <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
              </svg>
              </p> 
            </div>
          </div>
          <!-- /// INTELLIGENCE ARTIFI /// -->

          <!-- +++ YOUR MESSAGE +++ -->
          <div class="box4 col-md-10 visually-hidden" >
            <div class="user-message visually-hidden">
           
        
            </div>
          </div>
          <!-- /// YOUR MESSAGE /// -->
        </div>  

        <!-- +++ FOOTER INPUT AREA +++ -->
        <div class="container text-center" style="background: #C0C0C0;">
          <div class="row align-items-center p-2">
            <div class="col-10 ">
              <input class="form-control" type="text" name="userInput" id="userInput" placeholder="Please enter your message here"> 
            </div>
            <div class="col-2">
                <img src="/img/send_whatsapp_blu.png" role="button" class="img-fluid rounded-circle" id="send" value="Send"> 
                
                   


            </div>
          </div>
        </div>
        <?php 
          function validating($user_messages)
          {
            if(preg_match('/^[0-9]{10}+$/', $user_messages)) 
              {
                echo "Valid Phone Number";
                } else {
                echo "Invalid Phone Number";
              }
          }
        ?>
      </div>
    </div>
  </div>
</div>




<script type="text/javascript">

var flag = 0 ; 
// Input AUTO FOCUS 
$('#modal_whatsapp').on('shown.bs.offcanvas', function () {
    $('#userInput').focus();
})  
// Tasto ENTER  
  document.getElementById("userInput")
  .addEventListener("keyup", function(e) {
  if (e.keyCode === 13) {
  document.getElementById("send").click();
  }
  });
// AJAX
  document.querySelector("#send").addEventListener("click", async () => {
    // create new request object. get user message
    let xhr = new XMLHttpRequest();
    let userMessage = document.querySelector("#userInput").value;

    // create html to hold user message. 
      let userHtml = 
      '<div class="box4 col-md-10 userSection">' + 
          userMessage + 
          '<p class="text-end text-dark p-0 m-0 me-1 mt-0" style="font-size: smaller;">' + 
          '<?php echo date("H:i"); ?>'  +
          '   <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check2 text-secondary" viewBox="0 0 16 16">'
              + ' <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>'
              + '</svg>' + '</p>' +
        // '</div>'+
      '</div>'
      if (userMessage === "")
      {
        return;
      }
    // insert user message into the page
    document.querySelector('#body_whatsapp').innerHTML+= userHtml;
    document.querySelector("#userInput").value = "";
    // open a post request to server script. pass user message as parameter 
     xhr.open("POST", "../../CV_RESPONSIVE/whatsapp_contact/query_whatsapp.php");

    xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhr.send(`messageValue=${userMessage}`);

    // When response is returned, get reply text into HTML and insert in page
    xhr.onload = function () {
        let botHtml = 
        '<div class="box3 col-md-10">' + 
        '<div class="bot-reply">' + 
              this.responseText  +  
          '</div>' +
          '</div>' 
        document.querySelector('#body_whatsapp').innerHTML+= botHtml;
    // Getting the height of the document
    var n = $(document).height() + flag;
    $('botHtml, #body_whatsapp').animate({ scrollTop: n }, 'fast');
    flag = flag + 1000;
    return (n);
    }
  })

</script>



   